<!DOCTYPE html>
<html lang="en">
<head>
    <script>
        (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
        })(window,document,'script','dataLayer','GTM-WM4PT5V5');
    </script>
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-6B2W6EERMK"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
    
      gtag('config', 'G-6B2W6EERMK');
    </script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Modern Login Page</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Custom styles to ensure a consistent font and background */
        body {
            font-family: 'Inter', sans-serif;
            /* Modern, subtle gradient background for the entire page - now green/teal */
            background: linear-gradient(135deg, #d1f7e0 0%, #a7e6c4 100%);
            color: #374151; /* Dark gray text */
        }
        /* Styling for the message box that appears on form submission */
        .message-box {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            padding: 1rem 2rem;
            border-radius: 0.75rem; /* Slightly more rounded corners */
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15); /* Stronger, softer shadow */
            z-index: 1000;
            display: none;
            font-weight: 600;
            text-align: center;
            animation: fadeInOut 3.5s forwards; /* Add fade in/out animation */
        }
        /* Success message styling */
        .message-box.success {
            background-color: #d1fae5;
            color: #065f46;
            border: 1px solid #34d399;
        }
        /* Error message styling */
        .message-box.error {
            background-color: #fee2e2;
            color: #991b1b;
            border: 1px solid #ef4444;
        }

        /* Keyframe animation for message box fade in/out */
        @keyframes fadeInOut {
            0% { opacity: 0; transform: translateX(-50%) translateY(-20px); }
            10% { opacity: 1; transform: translateX(-50%) translateY(0); }
            90% { opacity: 1; transform: translateX(-50%) translateY(0); }
            100% { opacity: 0; transform: translateX(-50%) translateY(-20px); }
        }

        /* Enhanced input focus styles - now emerald-themed */
        input:focus, textarea:focus {
            border-color: #10b981; /* Emerald-500 */
            box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.3); /* Emerald-500 with opacity */
        }
    </style>
</head>
<body class="min-h-screen flex flex-col items-center justify-center p-4">
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-WM4PT5V5"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <div id="messageBox" class="message-box"></div>

    <div id="authContainer" class="w-full max-w-md bg-white rounded-xl shadow-2xl p-10 md:p-14 mb-8">
        <h1 class="text-4xl font-extrabold text-center text-emerald-800 mb-10">Welcome!</h1>

        <section id="loginSection">
            <h2 class="text-3xl font-bold text-center text-gray-800 mb-8">Login</h2>
            <form id="loginForm" class="space-y-6">
                <div>
                    <label for="username" class="block text-gray-700 text-base font-medium mb-2">Username</label>
                    <input type="text" id="username" name="username" placeholder="Enter your username"
                           class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-emerald-500 transition duration-200" required>
                    <p id="usernameError" class="text-red-500 text-xs mt-1 hidden">Please enter your username.</p>
                </div>
                <div>
                    <label for="password" class="block text-gray-700 text-base font-medium mb-2">Password</label>
                    <input type="password" id="password" name="password" placeholder="Enter your password"
                           class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-emerald-500 transition duration-200" required>
                    <p id="passwordError" class="text-red-500 text-xs mt-1 hidden">Please enter your password.</p>
                </div>
                <button type="submit"
                        class="w-full bg-emerald-600 text-white py-3 rounded-lg font-semibold text-lg hover:bg-emerald-700 transition duration-300 ease-in-out transform hover:scale-105 shadow-lg">
                    Login
                </button>
                <div class="text-center mt-4">
                    <a href="#" id="forgotPasswordLink" class="text-emerald-600 hover:underline text-sm">Forgot Password?</a>
                </div>
            </form>
        </section>

        <section id="forgotPasswordSection" class="hidden">
            <h2 class="text-3xl font-bold text-center text-gray-800 mb-8">Forgot Password</h2>
            <form id="forgotPasswordForm" class="space-y-6">
                <div>
                    <label for="resetEmail" class="block text-gray-700 text-base font-medium mb-2">Username or Email</label>
                    <input type="text" id="resetEmail" name="resetEmail" placeholder="Enter your username or email"
                           class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-emerald-500 transition duration-200" required>
                    <p id="resetEmailError" class="text-red-500 text-xs mt-1 hidden">Please enter your username or email.</p>
                </div>
                <button type="submit"
                        class="w-full bg-emerald-600 text-white py-3 rounded-lg font-semibold text-lg hover:bg-emerald-700 transition duration-300 ease-in-out transform hover:scale-105 shadow-lg">
                    Send Reset Link
                </button>
                <div class="text-center mt-4">
                    <a href="#" id="backToLoginLink" class="text-gray-600 hover:underline text-sm">Back to Login</a>
                </div>
            </form>
        </section>
    </div>

    <div id="loggedInContent" class="hidden w-full max-w-4xl bg-white rounded-xl shadow-2xl p-10 md:p-14 mb-8 flex flex-col items-center justify-center"
          style="min-height: 400px; background: linear-gradient(135deg, #d1f7e0 0%, #a7e6c4 100%);">
        <p class="text-5xl font-extrabold text-gray-800 text-center mb-10 drop-shadow-lg">Welcome to the page!</p>
        <button id="logoutButton"
                class="mt-10 bg-red-600 text-white py-3 px-6 rounded-lg font-semibold text-lg hover:bg-red-700 transition duration-300 ease-in-out transform hover:scale-105 shadow-lg">
            Logout
        </button>
    </div>

    <script>
        // Function to display messages (success/error) to the user
        function showMessage(message, type) {
            const messageBox = document.getElementById('messageBox');
            messageBox.textContent = message;
            messageBox.className = 'message-box ' + type;
            messageBox.style.display = 'block';

            // The animation handles hiding, but a manual hide is good as a fallback
            setTimeout(() => {
                messageBox.style.display = 'none';
            }, 3500); // Match animation duration
        }

        // --- Elements ---
        const loginForm = document.getElementById('loginForm');
        const authContainer = document.getElementById('authContainer');
        const loggedInContent = document.getElementById('loggedInContent');
        const logoutButton = document.getElementById('logoutButton');
        const loginSection = document.getElementById('loginSection');
        const forgotPasswordSection = document.getElementById('forgotPasswordSection'); // New
        const forgotPasswordLink = document.getElementById('forgotPasswordLink');      // New
        const backToLoginLink = document.getElementById('backToLoginLink');          // New
        const forgotPasswordForm = document.getElementById('forgotPasswordForm');      // New

        // Hardcoded credentials for simulation
        const CORRECT_USERNAME = 'Dharma';
        const CORRECT_PASSWORD = '1234';

        // --- Initial User Status for GA4 (on page load) ---
        // Assuming user is initially logged out.
        gtag('set', 'user_properties', {
          login_status: 'logged_out'
        });

        // --- Login Form Logic ---
        loginForm.addEventListener('submit', function(event) {
            event.preventDefault();

            let isValidLogin = true;

            const usernameInput = document.getElementById('username');
            const passwordInput = document.getElementById('password');

            const usernameError = document.getElementById('usernameError');
            const passwordError = document.getElementById('passwordError');

            usernameError.classList.add('hidden');
            passwordError.classList.add('hidden');

            // Send a custom event for each login attempt
            gtag('event', 'login_attempt', {
                'login_attempts_count': 1 // Custom metric value
            });


            if (usernameInput.value.trim() === '') {
                usernameError.classList.remove('hidden');
                isValidLogin = false;
            }
            if (passwordInput.value.trim() === '') {
                passwordError.classList.remove('hidden');
                isValidLogin = false;
            }

            if (isValidLogin) {
                if (usernameInput.value === CORRECT_USERNAME && passwordInput.value === CORRECT_PASSWORD) {
                    showMessage('Login successful! Welcome!', 'success');
                    authContainer.classList.add('hidden'); // Hide the authentication container
                    loggedInContent.classList.remove('hidden'); // Show the logged-in content
                    loginForm.reset(); // Clear login form

                    // GA4: Successful login event
                    gtag('event', 'login', {
                        'method': 'username_password', // Example parameter
                        'login_result': 'success',
                        'login_attempts_count': 0 // Reset for next successful login
                    });
                    // GA4: Update user property for login status
                    gtag('set', 'user_properties', {
                      login_status: 'logged_in'
                    });

                } else {
                    showMessage('Invalid username or password. Please try again.', 'error');
                    // GA4: Failed login event
                    gtag('event', 'login', {
                        'method': 'username_password',
                        'login_result': 'failure',
                        'login_attempts_count': 0 // Reset for next successful login
                    });
                }
            } else {
                showMessage('Please enter your username and password.', 'error');
                // GA4: Failed login due to empty fields
                 gtag('event', 'login', {
                    'method': 'username_password',
                    'login_result': 'empty_fields', // More specific failure
                    'login_attempts_count': 0 // Reset for next successful login
                });
            }
        });

        // --- Forgot Password Logic (New Section) ---
        forgotPasswordLink.addEventListener('click', function(event) {
            event.preventDefault();
            loginSection.classList.add('hidden'); // Hide login form
            forgotPasswordSection.classList.remove('hidden'); // Show forgot password form
            forgotPasswordForm.reset(); // Clear form fields
            document.getElementById('resetEmailError').classList.add('hidden'); // Hide any previous error

            // GA4: Event for navigating to forgot password
            gtag('event', 'navigate_forgot_password');
        });

        backToLoginLink.addEventListener('click', function(event) {
            event.preventDefault();
            forgotPasswordSection.classList.add('hidden'); // Hide forgot password form
            loginSection.classList.remove('hidden'); // Show login form
            loginForm.reset(); // Clear form fields
            document.getElementById('usernameError').classList.add('hidden'); // Hide any previous errors
            document.getElementById('passwordError').classList.add('hidden');

            // GA4: Event for navigating back to login
            gtag('event', 'navigate_back_to_login');
        });

        forgotPasswordForm.addEventListener('submit', function(event) {
            event.preventDefault();

            const resetEmailInput = document.getElementById('resetEmail');
            const resetEmailError = document.getElementById('resetEmailError');

            resetEmailError.classList.add('hidden');

            // Send a custom event for each forgot password attempt
            gtag('event', 'forgot_password_attempt', {
                'forgot_password_attempts_count': 1 // Custom metric value
            });

            if (resetEmailInput.value.trim() === '') {
                resetEmailError.classList.remove('hidden');
                showMessage('Please enter your username or email to reset password.', 'error');
                // GA4: Failed forgot password due to empty field
                gtag('event', 'forgot_password_submit', {
                    'forgot_password_result': 'empty_field',
                    'forgot_password_attempts_count': 0 // Reset for next successful attempt
                });
            } else {
                // Simulate sending a reset link
                showMessage('A password reset link has been sent to ' + resetEmailInput.value + '.', 'success');
                forgotPasswordForm.reset(); // Clear the form
                // Optionally, go back to login after sending link
                setTimeout(() => {
                    forgotPasswordSection.classList.add('hidden');
                    loginSection.classList.remove('hidden');
                }, 2000); // Wait 2 seconds before returning to login

                // GA4: Successful forgot password request
                gtag('event', 'forgot_password_submit', {
                    'forgot_password_result': 'link_sent',
                    'forgot_password_attempts_count': 0 // Reset for next successful attempt
                });
            }
        });

        // --- Logout Logic ---
        logoutButton.addEventListener('click', function() {
            showMessage('You have been logged out.', 'success');
            loggedInContent.classList.add('hidden'); // Hide the logged-in content
            authContainer.classList.remove('hidden'); // Show the authentication container again
            loginSection.classList.remove('hidden'); // Ensure login section is visible
            forgotPasswordSection.classList.add('hidden'); // Ensure forgot password section is hidden

            // GA4: Logout event
            gtag('event', 'logout');
            // GA4: Update user property for login status
            gtag('set', 'user_properties', {
              login_status: 'logged_out'
            });
        });
    </script>
</body>
</html>
